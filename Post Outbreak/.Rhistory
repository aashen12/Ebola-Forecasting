knitr::opts_chunk$set(echo = TRUE)
n<-300
x<-seq(0,1,length.out=n)
y<-sin(2*pi*x^2)*10+rnorm(n)
plot(x,y)
knotnum <- 5
its = 3000
source("mcmc_spline_fixed.R")
res <- mcmc_spline(knotnum)
mat_beta <- res[[1]]
mat_sig <- res[[2]]
mat_t <- res[[3]]
X_curr <- res[[4]]
ar <- res[[5]]
mat_s <- res[[6]]
colMeans(mat_beta)
colMeans(mat_t)
mean(mat_sig)
ar
matplot(mat_beta, type = "l", main = "Plot of Regression Coefficients")
plot(mat_sig, type = "l", main = "Plot of Sigma^2")
matplot(mat_t, type = "l", main = "Plot of Knot Locations")
mean.pred <- matrix(NA, nrow = its, ncol = length(x))
pred <- mean.pred
for(p in 1:its) {
mean.pred[p,] <- spline.basis(nknot = knotnum, knots = mat_t[p,], signs = mat_s[p,]) %*% mat_beta[p,]
pred[p,] <- mean.pred[p,] + rnorm(length(x), sd = sqrt(mat_sig[p]))
}
mean.pred <- t(mean.pred)
pred_adj <- t(apply(pred, 2, quantile, probs = c(0.025, 0.975)))
matplot(x, pred_adj, col = "lightgrey", lwd = 6, type = "l")
matplot(x, mean.pred, type = "l", lwd = 3, add = TRUE)
points(x, y)
plot(x, rowMeans(mean.pred), lwd = 10, type = "l", col = "royalblue")
points(x, y)
rm(list=ls())
library(tidyverse)
library(lubridate)
true <- read.csv("/Volumes/GoogleDrive/.shortcut-targets-by-id/15UGkfREtfqH3LdfHmCsSpFJ5SrTnSeyt/ebola/2020-05-04_ebola/2020-05-04_data.csv")
true <- true[1:733,]
colnames(true) <- c("date", "cases")
true$date <- mdy(true$date)
true$cases[is.na(true$cases)] <- 0
true <- true %>% mutate(total = cumsum(cases))
last_date <- true$date[length(true$date)]
last_case <- true$total[length(true$total)]
plot(true$date, true$total, type = "l", lwd = 3,
xlab = "Date", ylab = "Total Cases",
main = "Actual Recorded DRC Ebola Cases")
source("outbreak_vis.R")
p <- ggplot(data = true,
mapping = aes(x = date, y = total)) +
geom_line() + theme_light() # grapho of runinng total of cases
p + labs(title = "Actual Recorded DRC Ebola Cases")
max(ymd("2020-09-23","2020-10-12","2019-12-30"))
title <- "Forecasts vs Actual in 2018"
dv <- c("2018-08-27","2018-09-27","2018-10-31","2018-11-29","2018-12-30")
mt <- cbind(c(15,24,31),c(10,18,27),c(15,28,42),c(15,29,41),c(21,40,60))
multi_forecast(dv, mt, title = title) #shows predicted vs actual for three forecasts
